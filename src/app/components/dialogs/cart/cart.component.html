<ng-container *ngLet="cartItems$ | async as items">
  <h2 mat-dialog-title class="title" data-test="cart-dialog-title">Shopping Cart</h2>
  <mat-dialog-content class="content">
    <div *ngIf="isCartEmpty(items)" class="cart-empty" data-test="cart-dialog-empty">
      <img
        class="cart-empty__img"
        src="/assets/img/shopping-cart.svg"
        alt="Shopping cart with minus sign"
      />
      <!--      TODO: Icon attribution -->
      <!--      <div>-->
      <!--        Icons made by-->
      <!--        <a href="https://www.flaticon.com/authors/pixel-perfect" title="Pixel perfect">-->
      <!--          Pixel perfect-->
      <!--        </a>-->
      <!--        from-->
      <!--        <a href="https://www.flaticon.com/" title="Flaticon">www.flaticon.com</a>-->
      <!--      </div>-->
      <p class="cart-empty__msg">Cart is empty :(</p>
    </div>

    <table *ngIf="!isCartEmpty(items)" class="cart-table" data-test="cart-dialog-orders">
      <tbody>
        <tr
          *ngFor="let item of items"
          class="cart-table__row"
          data-test="cart-dialog-row"
        >
          <td>
            <img [src]="item.dish.image" alt="Image of {{ item.dish.title }}" />
          </td>
          <td>
            <span class="cart-table__dish">{{ item.quantity }}</span>
            <span class="highlight">&nbsp; x &nbsp;</span>
            <span class="cart-table__dish">{{ item.dish.title }}</span>
          </td>
          <td class="cart-table__price">
            {{ item.quantity * item.dish.price | currency }}
          </td>
          <td class="cart-table__btn">
            <button
              mat-icon-button
              color="warn"
              (click)="removeItemFromCart(item)"
              data-test="cart-dialog-remove-item-btn"
            >
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
      <tfoot class="cart-table__footer" data-test="cart-table-footer">
        <tr>
          <td colspan="2">Total</td>
          <td class="cart-table__price">{{ getTotal(items) | currency }}</td>
        </tr>
      </tfoot>
    </table>
  </mat-dialog-content>

  <mat-dialog-actions
    *ngIf="!isCartEmpty(items)"
    align="end"
    data-test="cart-dialog-actions"
  >
    <button
      mat-raised-button
      color="primary"
      (click)="checkout(items)"
      data-test="cart-dialog-checkout-btn"
    >
      Checkout
    </button>
  </mat-dialog-actions>
</ng-container>
